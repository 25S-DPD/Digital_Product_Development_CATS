- story: Patient denies changes, save data
  steps:
  - action: action_summary
  - intent: deny
  - action: action_save_patient_data

- story: file upload flow
  steps:
  - active_loop: medical_history_form
  - slot_was_set:
    - requested_slot: recent_exams
  - intent: upload_files
  - action: utter_message
    text: "Please upload your test results using the file upload option."
  - user_message: "Uploaded files: example.pdf"
  - action: action_handle_file_upload
  - intent: no_more_files
  - action: action_handle_file_upload
  - action: medical_history_form
  - active_loop: null

- story: file upload more files
  steps:
  - active_loop: medical_history_form
  - slot_was_set:
    - requested_slot: recent_exams
  - user_message: "Uploaded files: example.pdf"
  - action: action_handle_file_upload
  - intent: upload_more_files
  - action: action_handle_file_upload
  - user_message: "Uploaded files: example2.pdf"
  - action: action_handle_file_upload
  - intent: no_more_files
  - action: action_handle_file_upload
  - action: medical_history_form
  - active_loop: null

- story: imaging lab access - user wants to share
  steps:
    - active_loop: medical_history_form
    - slot_was_set:
      - requested_slot: imaging_lab_access
    - intent: affirm
    - action: validate_medical_history_form
    - slot_was_set:
      - imaging_lab_access: "Yes"
      - collecting_lab_info: true
    - action: action_collect_lab_url

- story: imaging lab access - user doesn't want to share
  steps:
    - active_loop: medical_history_form
    - slot_was_set:
      - requested_slot: imaging_lab_access
    - intent: deny
    - action: validate_medical_history_form
    - slot_was_set:
      - imaging_lab_access: "No"

- story: lab collection flow - add more labs
  steps:
    - slot_was_set:
      - collecting_lab_info: true
    - action: action_collect_lab_url
    - user: |
        www.example.com
    - action: action_collect_lab_password
    - user: |
        password123
    - action: action_handle_add_more_labs
    - intent: affirm
    - action: action_collect_lab_url

- story: lab collection flow - finish adding labs
  steps:
    - slot_was_set:
      - collecting_lab_info: true
    - action: action_handle_add_more_labs
    - intent: deny
    - slot_was_set:
      - collecting_lab_info: false
